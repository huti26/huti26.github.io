<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Lewis Hamilton 2017-2021 | Hutan Baghery Moghaddam</title><meta name=keywords content="Formula 1,SQL,Python,Pandas,R"><meta name=description content="An analysis of various race statistics in regard to Lewis Hamilton. Hamilton will be compared to his teammate Valteri Bottas and the other Championship Contenders during those years, namely Sebastian Vettel and Max Verstappen."><meta name=author content="Hutan Baghery Moghaddam"><link rel=canonical href=https://huti26.github.io/posts/formula-1/lewis-hamilton-2017-2021/><link crossorigin=anonymous href=../../../assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=../../../assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://huti26.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://huti26.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://huti26.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://huti26.github.io/apple-touch-icon.png><link rel=mask-icon href=https://huti26.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Lewis Hamilton 2017-2021"><meta property="og:description" content="An analysis of various race statistics in regard to Lewis Hamilton. Hamilton will be compared to his teammate Valteri Bottas and the other Championship Contenders during those years, namely Sebastian Vettel and Max Verstappen."><meta property="og:type" content="article"><meta property="og:url" content="https://huti26.github.io/posts/formula-1/lewis-hamilton-2017-2021/"><meta property="og:image" content="https://huti26.github.io/merc-2021-celebration.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-23T00:00:00+00:00"><meta property="og:site_name" content="Hutan Baghery Moghaddam"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://huti26.github.io/merc-2021-celebration.jpg"><meta name=twitter:title content="Lewis Hamilton 2017-2021"><meta name=twitter:description content="An analysis of various race statistics in regard to Lewis Hamilton. Hamilton will be compared to his teammate Valteri Bottas and the other Championship Contenders during those years, namely Sebastian Vettel and Max Verstappen."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://huti26.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Lewis Hamilton 2017-2021","item":"https://huti26.github.io/posts/formula-1/lewis-hamilton-2017-2021/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Lewis Hamilton 2017-2021","name":"Lewis Hamilton 2017-2021","description":"An analysis of various race statistics in regard to Lewis Hamilton. Hamilton will be compared to his teammate Valteri Bottas and the other Championship Contenders during those years, namely Sebastian Vettel and Max Verstappen.","keywords":["Formula 1","SQL","Python","Pandas","R"],"articleBody":"Preface The 2021 season of Formula 1 is the first one I watched and I have been a fan of both Hamilton and Bottas ever since. During this season Bottas has been criticized a lot. That’s why I wanted to do a bit of data analysis on how Hamilton and Bottas compare in raw numbers. Raw numbers are not a particularly good way to make hard statements in Formula 1, since they lack a lot of context. However, the raw numbers can be used as an indicator to find outliers or general trends, which then should be further analyzed with context. Additionally, there will be some comparisons between Lewis Hamilton and Sebastian Vettel during their Championship Races in 2017 and 2018. The same comparisons will be done for the 2021 season in which Lewis Hamilton and Max Verstappen competed for the Championship.\nData Source The used data can be found on Kaggle: Formula 1 World Championship (1950 - 2022). The original data source is the Ergast Developer API. The maintainers on Kaggle provide 14 CSV files containing information about drivers, constructors, and all kinds of results. The data is built in a relational format, so it can easily be imported into a SQL database of choice. In this case, SQLite is entirely sufficient. Additionally, some transformations will be made with the Python library Pandas.\nData Engineering The source code can be found on GitHub\nInitial data transformations are done in SQL and the results are in the /data folder. Any further transformations done with Pandas are stored in the /hamilton-vs-bottas folder.\nThe first analyzed data is about the race pace. For that, the lap times of Hamilton and Bottas from 2017 to 2021 were extracted. Transformations are explained in detail for this first analysis and omitted for the others. All transformations can be found in the mentioned repository and if these steps are not of your interest, just skip ahead to the analysis.\nSELECT lap_times.raceId, lap_times.driverId, lap_times.lap, lap_times.position, lap_times.milliseconds, races.year, races.round, races.name, races.date, drivers.code, drivers.forename, drivers.surname, drivers.dob, drivers.nationality, circuits.name, circuits.country, results.statusId FROM lap_times, races, drivers, circuits, results WHERE (lap_times.driverId = 1 OR lap_times.driverId = 822) AND results.statusId = 1 AND (year \u003e= 2017 AND year \u003c= 2021) AND lap_times.driverId = drivers.driverId AND lap_times.raceId = races.raceId AND races.circuitId = circuits.circuitId AND results.raceId = lap_times.raceId AND results.driverId = lap_times.driverId This data contains the lap time of each lap that Hamilton and Bottas drove. To further analyze this data, it was transformed with Pandas.\nFirst, the mean race pace was created.\ndata = pd.read_csv(\"data/lap_times_ham_vs_bot_without_dnfs.csv\") means = data.groupby([\"race_name\", \"circuit_name\", \"year\", \"code\"])[\"milliseconds\"].mean().reset_index() means.to_csv(\"hamilton-vs-bottas/racepace-means-alphabetical.csv\", index=False) This data is now in the long format, but we require wide format data for the next step, in which we calculate the Deltas. Delta here simply means the difference in mean race pace between the drivers.\ndata = pd.read_csv(\"hamilton-vs-bottas/racepace-means-alphabetical.csv\") data = data.pivot(index=[\"race_name\", \"circuit_name\", \"year\"], columns=\"code\", values=\"milliseconds\").reset_index() data.to_csv(\"hamilton-vs-bottas/racepace-means-alphabetical-wide.csv\", index=False) Before we calculate the Deltas, we remove the 2021 race in Belgium. This is an outlier race, that did not start due to rain.\ndata = pd.read_csv(\"hamilton-vs-bottas/racepace-means-alphabetical-wide.csv\") data = data.drop(data[(data[\"circuit_name\"] == \"Circuit de Spa-Francorchamps\") \u0026 (data[\"year\"] == 2021)].index) data.to_csv(\"hamilton-vs-bottas/racepace-means-alphabetical-wide-without-spa-2021.csv\", index=False) Finally, we can calculate the Deltas.\ndata = pd.read_csv(\"hamilton-vs-bottas/racepace-means-alphabetical-wide-without-spa-2021.csv\") data[\"delta\"] = data[\"BOT\"] - data[\"HAM\"] data.to_csv(\"hamilton-vs-bottas/racepace-means-alphabetical-wide-without-spa-with-deltas.csv\", index=False) Data Analysis All visualizations are created with R and ggplot.\nRacepace Here one can see two strong outliers in 2021. Race 2 and 12 favor Bottas and Hamilton respectively. In race 2 there was a DNF, which means that one of the drivers did not finish the race in case you are not familiar with Formula 1. So next, all races containing DNFs were removed.\nOne can see, that not only did the second race of 2021 get removed but also a couple of others too. This is good because the races with DNFs skew the data. However, the outlier race 12 in 2021 was not removed. This is because race 12 of 2021 is the Belgium Grand Prix, which only ran for two laps due to rain. We remove that race too.\nFinally, we can analyze the filtered data. The years in which Bottas contested Hamilton for the Championship were 2019 and 2020. Race pace-wise Bottas was faster 10 times, while Hamilton was faster 24 times. Also, when Hamilton was faster than Bottas, he was faster by a bigger margin. Similar trends can be found in the other seasons too, although it is noteworthy, that especially in the later races of the seasons Mercedes has favored Hamilton since he was the one competing for the Championship.\nThe plots above show the performance chronologically, the races are sorted from first race to last race. In the following plot, the performance sorted by racetrack is analyzed instead.\nA particularly strong track for Hamilton is his home race, the British Grand Prix. Hamilton is unbeaten by Bottas in front of his home crowd. Spa (The Belgian Grand Prix) and Barcelona (The Spanish Grand Prix) are also unbeaten tracks for Hamilton. On the other hand, Bottas has outperformed Hamilton both on the Austrian Grand Prix and in Baku (The Azerbaijan Grand Prix). Exceptionally strong races by Bottas can be found in the 2017 Russian Grand Prix, the 2019 Italian Grand Prix, and the 2021 Turkish Grand Prix.\nDNFs DNFs are another interesting aspect to analyze. Hamilton, who is self-proclaimed blessed, is known to have very DNFs, while Bottas is known for some unlucky DNFs such as his Pitstop in Monaco in 2021.\nIn the plot, we can see, that Hamilton has DNFed twice from 2017 to 2021, while Bottas has DNFed 10 times. Noteworthy is that Bottas has DNFed every single time in the 11th race since 2019. At the time I am writing this, the 10th race of the 2022 season, the British Grand Prix, has just finished and the 11th race in Austria is around the corner. Hopefully the next time we analyze this type of data, we can say, that Bottas broke this curse.\nStandings Next, we will look at how close Bottas and Hamilton were points-wise. In grey, there will be a dotted line to indicate at which race the Championship was decided. It is important to note, that this refers to the point at which Hamilton won the Championship, Bottas has been out of the Championship race earlier than that in 2017, 2018, and 2021.\nThroughout all seasons Bottas was never ahead in points after the 5th race. Hamilton quickly built a fair margin in points and kept that throughout all the seasons, when compared with Bottas.\nPositions Next, we will move away from comparing only Hamilton and Bottas. Instead, we will look at the Championship Contenders of each year.\nIt is known, that Hamilton is particularly strong in the final phase of the Championship. First, let’s look at his title fight with Vettel in 2017 and 2018. In 2017 starting with race 12, he finished 1, 1, 1, 2, 1, 1. Then a 9th place finish was enough for him to win the Championship with two more races left. 2018 was very similar, starting with race 12 he finished 1, 2, 1, 1, 1, 1, which then allowed him to win the Championship with a 3rd and 4th place, with two more races left. During both of these Hamilton streaks, Vettel has struggled a lot. Vettel finished 2, 3, 18, 4, 19, 2 in 2017 and 2, 1, 4, 3, 3, 6 in 2018.\nThe finish of 2019 against Bottas was not as smooth 2017 and 2018. Hamilton and Bottas had a strong exchange of blows starting with race 13. Overall, Bottas still lost too many points prior to that and Hamilton won the Championship with two races left. 2020 was a very dominant season for Hamilton. The season had a couple fewer races than the others due to covid and Hamilton still concluded the Championship with three races left. This is also underlined by the mean race pace per year. In 2019 Bottas was 24 milliseconds faster on average, while Hamilton was 374 milliseconds faster on average in 2020.\nFinally, we can look at the 2021 season, which is the first season Hamilton lost since 2016. The Championship was decided in the very last race, with a really small margin. The 2021 season is the closest of all analyzed seasons. Hamilton had a very strong final phase here too. Starting with race 17, he finished 2nd twice behind Verstappen. At this point, the pressure was extremely high and Hamilton had to win the next three races, which he did.\nPitstops Formula 1 is of course a Constructors Sport. No matter how good a Driver is, if the car is not good enough, a Championship is simply not possible. Building a good car is only half the battle. During the races, the Team has to make the right calls regarding strategy and perform well during Pitstops. In the following, we will compare how much time the Championship Contenders lost or gained during their Pitstops. Each bar in the following plot represents the Delta between two Pitstops. If for example, Hamilton has a two Pitstop race and Verstappen has a three Pitstop race, there will only be two bars for that race: One for comparing Hamilton’s first Pitstop to Verstappen’s first Pitstop and another one for comparing Hamilton’s second Pitstop to Verstappens second Pitstop. Additionally, we exclude any Pitstops with Deltas larger than 4 seconds. This is done to avoid comparing a normal Pitstop in which only the tyres are changed to a Pitstop in which a damaged front wing had to be replaced.\nIn 2017 and 2018 the results are fairly close in terms of how often each driver gained an advantage. Vettel gained time 21 times, while Hamilton gained time 28 times. However, the overall mean time gain per Pitstop for 2017 and 2018 respectively was 381 and 271 milliseconds in favor of Hamilton.\nIn 2019 and 2020 the Pitstops are a lot closer. Overall Bottas gained 49 milliseconds in 2019 and 79 milliseconds in 2020 on average.\nRed Bull is known for their fast Pitstops. This is represented by the data as well. In the 30 compared Pitstops Mercedes only beat Red Bull 9 times in 2021. On average Verstappen gained 268 milliseconds per Pitstop during that season.\nConclusion As mentioned at the start, the data should not be overinterpreted. Instead of drawing conclusions from this data, we looked at commonly known things in Formula 1, such as Red Bull’s strong Pitstops and Hamilton’s strong final phase, and looked if we could find these impressions in the data. Overall this was a fun way for me to refresh my SQL, Pandas, and ggplot knowledge.\n","wordCount":"1773","inLanguage":"en","image":"https://huti26.github.io/merc-2021-celebration.jpg","datePublished":"2022-06-23T00:00:00Z","dateModified":"2022-06-23T00:00:00Z","author":{"@type":"Person","name":"Hutan Baghery Moghaddam"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://huti26.github.io/posts/formula-1/lewis-hamilton-2017-2021/"},"publisher":{"@type":"Organization","name":"Hutan Baghery Moghaddam","logo":{"@type":"ImageObject","url":"https://huti26.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://huti26.github.io/ accesskey=h title="Hutan BM (Alt + H)">Hutan BM</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://huti26.github.io/links/ title=Links><span>Links</span></a></li><li><a href=https://huti26.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://huti26.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://huti26.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://huti26.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Lewis Hamilton 2017-2021</h1><div class=post-description>An analysis of various race statistics in regard to Lewis Hamilton. Hamilton will be compared to his teammate Valteri Bottas and the other Championship Contenders during those years, namely Sebastian Vettel and Max Verstappen.</div><div class=post-meta><span title='2022-06-23 00:00:00 +0000 UTC'>June 23, 2022</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1773 words&nbsp;·&nbsp;Hutan Baghery Moghaddam</div></header><figure class=entry-cover><img loading=lazy src=https://huti26.github.io/merc-2021-celebration.jpg alt="Source: https://www.mercedesamgf1.com/de/wallpaper/"><p>Source: <a href=https://www.mercedesamgf1.com/de/wallpaper/ target=_blank rel=noopener>https://www.mercedesamgf1.com/de/wallpaper/</a></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#preface>Preface</a></li><li><a href=#data-source>Data Source</a></li><li><a href=#data-engineering>Data Engineering</a></li><li><a href=#data-analysis>Data Analysis</a><ul><li><a href=#racepace>Racepace</a></li><li><a href=#dnfs>DNFs</a></li><li><a href=#standings>Standings</a></li><li><a href=#positions>Positions</a></li><li><a href=#pitstops>Pitstops</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><h2 id=preface>Preface<a hidden class=anchor aria-hidden=true href=#preface>#</a></h2><p>The 2021 season of Formula 1 is the first one I watched and I have been a fan of both Hamilton and Bottas ever since. During this season Bottas has been criticized a lot. That&rsquo;s why I wanted to do a bit of data analysis on how Hamilton and Bottas compare in raw numbers. Raw numbers are not a particularly good way to make hard statements in Formula 1, since they lack a lot of context. However, the raw numbers can be used as an indicator to find outliers or general trends, which then should be further analyzed with context. Additionally, there will be some comparisons between Lewis Hamilton and Sebastian Vettel during their Championship Races in 2017 and 2018. The same comparisons will be done for the 2021 season in which Lewis Hamilton and Max Verstappen competed for the Championship.</p><h2 id=data-source>Data Source<a hidden class=anchor aria-hidden=true href=#data-source>#</a></h2><p>The used data can be found on Kaggle: <a href=https://www.kaggle.com/datasets/rohanrao/formula-1-world-championship-1950-2020 target=_blank rel=noopener>Formula 1 World Championship (1950 - 2022)</a>. The original data source is the <a href=http://ergast.com/mrd/ target=_blank rel=noopener>Ergast Developer API</a>. The maintainers on Kaggle provide 14 CSV files containing information about drivers, constructors, and all kinds of results. The data is built in a relational format, so it can easily be imported into a SQL database of choice. In this case, SQLite is entirely sufficient. Additionally, some transformations will be made with the Python library Pandas.</p><h2 id=data-engineering>Data Engineering<a hidden class=anchor aria-hidden=true href=#data-engineering>#</a></h2><p>The source code can be found on <a href=https://github.com/huti26/formel-1-analysis target=_blank rel=noopener>GitHub</a></p><p>Initial data transformations are done in SQL and the results are in the <code>/data</code> folder. Any further transformations done with Pandas are stored in the <code>/hamilton-vs-bottas</code> folder.</p><p>The first analyzed data is about the race pace. For that, the lap times of Hamilton and Bottas from 2017 to 2021 were extracted. Transformations are explained in detail for this first analysis and omitted for the others. All transformations can be found in the mentioned repository and if these steps are not of your interest, just skip ahead to the analysis.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>lap_times</span><span class=p>.</span><span class=n>raceId</span><span class=p>,</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=n>driverId</span><span class=p>,</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=n>lap</span><span class=p>,</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=k>position</span><span class=p>,</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=n>milliseconds</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>races</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>races</span><span class=p>.</span><span class=n>round</span><span class=p>,</span><span class=w> </span><span class=n>races</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>races</span><span class=p>.</span><span class=nb>date</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>drivers</span><span class=p>.</span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=n>drivers</span><span class=p>.</span><span class=n>forename</span><span class=p>,</span><span class=w> </span><span class=n>drivers</span><span class=p>.</span><span class=n>surname</span><span class=p>,</span><span class=w> </span><span class=n>drivers</span><span class=p>.</span><span class=n>dob</span><span class=p>,</span><span class=w> </span><span class=n>drivers</span><span class=p>.</span><span class=n>nationality</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>circuits</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>circuits</span><span class=p>.</span><span class=n>country</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>results</span><span class=p>.</span><span class=n>statusId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>lap_times</span><span class=p>,</span><span class=w> </span><span class=n>races</span><span class=p>,</span><span class=w> </span><span class=n>drivers</span><span class=p>,</span><span class=w> </span><span class=n>circuits</span><span class=p>,</span><span class=w> </span><span class=n>results</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=n>lap_times</span><span class=p>.</span><span class=n>driverId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=n>driverId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>822</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>results</span><span class=p>.</span><span class=n>statusId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=k>year</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2017</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>year</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>2021</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>lap_times</span><span class=p>.</span><span class=n>driverId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>drivers</span><span class=p>.</span><span class=n>driverId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>lap_times</span><span class=p>.</span><span class=n>raceId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>races</span><span class=p>.</span><span class=n>raceId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>races</span><span class=p>.</span><span class=n>circuitId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>circuits</span><span class=p>.</span><span class=n>circuitId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>results</span><span class=p>.</span><span class=n>raceId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=n>raceId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>results</span><span class=p>.</span><span class=n>driverId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lap_times</span><span class=p>.</span><span class=n>driverId</span><span class=w>
</span></span></span></code></pre></div><p>This data contains the lap time of each lap that Hamilton and Bottas drove. To further analyze this data, it was transformed with Pandas.</p><p>First, the mean race pace was created.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;data/lap_times_ham_vs_bot_without_dnfs.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>means</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s2>&#34;race_name&#34;</span><span class=p>,</span> <span class=s2>&#34;circuit_name&#34;</span><span class=p>,</span> <span class=s2>&#34;year&#34;</span><span class=p>,</span> <span class=s2>&#34;code&#34;</span><span class=p>])[</span><span class=s2>&#34;milliseconds&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>means</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical.csv&#34;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span></code></pre></div><p>This data is now in the long format, but we require wide format data for the next step, in which we calculate the Deltas. Delta here simply means the difference in mean race pace between the drivers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;race_name&#34;</span><span class=p>,</span> <span class=s2>&#34;circuit_name&#34;</span><span class=p>,</span> <span class=s2>&#34;year&#34;</span><span class=p>],</span> <span class=n>columns</span><span class=o>=</span><span class=s2>&#34;code&#34;</span><span class=p>,</span> <span class=n>values</span><span class=o>=</span><span class=s2>&#34;milliseconds&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical-wide.csv&#34;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span></code></pre></div><p>Before we calculate the Deltas, we remove the 2021 race in Belgium. This is an outlier race, that did not start due to rain.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical-wide.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>data</span><span class=p>[(</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;circuit_name&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;Circuit de Spa-Francorchamps&#34;</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;year&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2021</span><span class=p>)]</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical-wide-without-spa-2021.csv&#34;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span></code></pre></div><p>Finally, we can calculate the Deltas.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical-wide-without-spa-2021.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=p>[</span><span class=s2>&#34;delta&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;BOT&#34;</span><span class=p>]</span> <span class=o>-</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;HAM&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&#34;hamilton-vs-bottas/racepace-means-alphabetical-wide-without-spa-with-deltas.csv&#34;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=data-analysis>Data Analysis<a hidden class=anchor aria-hidden=true href=#data-analysis>#</a></h2><p>All visualizations are created with R and ggplot.</p><h3 id=racepace>Racepace<a hidden class=anchor aria-hidden=true href=#racepace>#</a></h3><p><img loading=lazy src=../../../posts/formula-1/images/racepace-mean-ham-bot-delta-per-track.png alt></p><p>Here one can see two strong outliers in 2021. Race 2 and 12 favor Bottas and Hamilton respectively. In race 2 there was a DNF, which means that one of the drivers did not finish the race in case you are not familiar with Formula 1. So next, all races containing DNFs were removed.</p><p><img loading=lazy src=../../../posts/formula-1/images/racepace-mean-ham-bot-delta-per-track-without-dnfs.png alt></p><p>One can see, that not only did the second race of 2021 get removed but also a couple of others too. This is good because the races with DNFs skew the data. However, the outlier race 12 in 2021 was not removed. This is because race 12 of 2021 is the Belgium Grand Prix, which only ran for two laps due to rain. We remove that race too.</p><p><img loading=lazy src=../../../posts/formula-1/images/racepace-mean-ham-bot-delta-per-track-without-dnfs-without-spa-2021.png alt></p><p>Finally, we can analyze the filtered data. The years in which Bottas contested Hamilton for the Championship were 2019 and 2020. Race pace-wise Bottas was faster 10 times, while Hamilton was faster 24 times. Also, when Hamilton was faster than Bottas, he was faster by a bigger margin. Similar trends can be found in the other seasons too, although it is noteworthy, that especially in the later races of the seasons Mercedes has favored Hamilton since he was the one competing for the Championship.</p><p>The plots above show the performance chronologically, the races are sorted from first race to last race. In the following plot, the performance sorted by racetrack is analyzed instead.</p><p><img loading=lazy src=../../../posts/formula-1/images/racepace-mean-ham-bot-delta-per-track-alphabetical.png alt></p><p>A particularly strong track for Hamilton is his home race, the British Grand Prix. Hamilton is unbeaten by Bottas in front of his home crowd. Spa (The Belgian Grand Prix) and Barcelona (The Spanish Grand Prix) are also unbeaten tracks for Hamilton. On the other hand, Bottas has outperformed Hamilton both on the Austrian Grand Prix and in Baku (The Azerbaijan Grand Prix). Exceptionally strong races by Bottas can be found in the 2017 Russian Grand Prix, the 2019 Italian Grand Prix, and the 2021 Turkish Grand Prix.</p><h3 id=dnfs>DNFs<a hidden class=anchor aria-hidden=true href=#dnfs>#</a></h3><p>DNFs are another interesting aspect to analyze. Hamilton, who is self-proclaimed blessed, is known to have very DNFs, while Bottas is known for some unlucky DNFs such as his Pitstop in Monaco in 2021.</p><p><img loading=lazy src=../../../posts/formula-1/images/ham-bot-dnfs.png alt></p><p>In the plot, we can see, that Hamilton has DNFed twice from 2017 to 2021, while Bottas has DNFed 10 times. Noteworthy is that Bottas has DNFed every single time in the 11th race since 2019. At the time I am writing this, the 10th race of the 2022 season, the British Grand Prix, has just finished and the 11th race in Austria is around the corner. Hopefully the next time we analyze this type of data, we can say, that Bottas broke this curse.</p><h3 id=standings>Standings<a hidden class=anchor aria-hidden=true href=#standings>#</a></h3><p>Next, we will look at how close Bottas and Hamilton were points-wise. In grey, there will be a dotted line to indicate at which race the Championship was decided. It is important to note, that this refers to the point at which Hamilton won the Championship, Bottas has been out of the Championship race earlier than that in 2017, 2018, and 2021.</p><p><img loading=lazy src=../../../posts/formula-1/images/ham-bot-standings.png alt></p><p>Throughout all seasons Bottas was never ahead in points after the 5th race. Hamilton quickly built a fair margin in points and kept that throughout all the seasons, when compared with Bottas.</p><h3 id=positions>Positions<a hidden class=anchor aria-hidden=true href=#positions>#</a></h3><p>Next, we will move away from comparing only Hamilton and Bottas. Instead, we will look at the Championship Contenders of each year.</p><p><img loading=lazy src=../../../posts/formula-1/images/ham-bot-positions.png alt></p><p>It is known, that Hamilton is particularly strong in the final phase of the Championship.
First, let&rsquo;s look at his title fight with Vettel in 2017 and 2018. In 2017 starting with race 12, he finished 1, 1, 1, 2, 1, 1. Then a 9th place finish was enough for him to win the Championship with two more races left. 2018 was very similar, starting with race 12 he finished 1, 2, 1, 1, 1, 1, which then allowed him to win the Championship with a 3rd and 4th place, with two more races left. During both of these Hamilton streaks, Vettel has struggled a lot. Vettel finished 2, 3, 18, 4, 19, 2 in 2017 and 2, 1, 4, 3, 3, 6 in 2018.</p><p>The finish of 2019 against Bottas was not as smooth 2017 and 2018. Hamilton and Bottas had a strong exchange of blows starting with race 13. Overall, Bottas still lost too many points prior to that and Hamilton won the Championship with two races left. 2020 was a very dominant season for Hamilton. The season had a couple fewer races than the others due to covid and Hamilton still concluded the Championship with three races left. This is also underlined by the mean race pace per year. In 2019 Bottas was 24 milliseconds faster on average, while Hamilton was 374 milliseconds faster on average in 2020.</p><p>Finally, we can look at the 2021 season, which is the first season Hamilton lost since 2016. The Championship was decided in the very last race, with a really small margin. The 2021 season is the closest of all analyzed seasons. Hamilton had a very strong final phase here too. Starting with race 17, he finished 2nd twice behind Verstappen. At this point, the pressure was extremely high and Hamilton had to win the next three races, which he did.</p><h3 id=pitstops>Pitstops<a hidden class=anchor aria-hidden=true href=#pitstops>#</a></h3><p>Formula 1 is of course a Constructors Sport. No matter how good a Driver is, if the car is not good enough, a Championship is simply not possible. Building a good car is only half the battle. During the races, the Team has to make the right calls regarding strategy and perform well during Pitstops. In the following, we will compare how much time the Championship Contenders lost or gained during their Pitstops. Each bar in the following plot represents the Delta between two Pitstops. If for example, Hamilton has a two Pitstop race and Verstappen has a three Pitstop race, there will only be two bars for that race: One for comparing Hamilton&rsquo;s first Pitstop to Verstappen&rsquo;s first Pitstop and another one for comparing Hamilton&rsquo;s second Pitstop to Verstappens second Pitstop. Additionally, we exclude any Pitstops with Deltas larger than 4 seconds. This is done to avoid comparing a normal Pitstop in which only the tyres are changed to a Pitstop in which a damaged front wing had to be replaced.</p><p><img loading=lazy src=../../../posts/formula-1/images/pit-stop-deltas-2.png alt></p><p>In 2017 and 2018 the results are fairly close in terms of how often each driver gained an advantage. Vettel gained time 21 times, while Hamilton gained time 28 times. However, the overall mean time gain per Pitstop for 2017 and 2018 respectively was 381 and 271 milliseconds in favor of Hamilton.</p><p>In 2019 and 2020 the Pitstops are a lot closer. Overall Bottas gained 49 milliseconds in 2019 and 79 milliseconds in 2020 on average.</p><p>Red Bull is known for their fast Pitstops. This is represented by the data as well. In the 30 compared Pitstops Mercedes only beat Red Bull 9 times in 2021. On average Verstappen gained 268 milliseconds per Pitstop during that season.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>As mentioned at the start, the data should not be overinterpreted. Instead of drawing conclusions from this data, we looked at commonly known things in Formula 1, such as Red Bull&rsquo;s strong Pitstops and Hamilton&rsquo;s strong final phase, and looked if we could find these impressions in the data. Overall this was a fun way for me to refresh my SQL, Pandas, and ggplot knowledge.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://huti26.github.io/tags/formula-1/>Formula 1</a></li><li><a href=https://huti26.github.io/tags/sql/>SQL</a></li><li><a href=https://huti26.github.io/tags/python/>Python</a></li><li><a href=https://huti26.github.io/tags/pandas/>Pandas</a></li><li><a href=https://huti26.github.io/tags/r/>R</a></li></ul><nav class=paginav><a class=prev href=https://huti26.github.io/posts/distributed-rocksdb/distributed-rocksdb/><span class=title>« Prev</span><br><span>Making Meta's RocksDB distributed with UCX to support Infiniband Hardware</span></a>
<a class=next href=https://huti26.github.io/posts/flutter-calorietracker/flutter-calorietracker/><span class=title>Next »</span><br><span>Building a Calorietracker WebApp with Flutter and Firebase</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://huti26.github.io/>Hutan Baghery Moghaddam</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>